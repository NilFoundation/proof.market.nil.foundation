import{r as s,o as Q,b7 as Y,aY as _,b8 as K,b9 as X,aW as f,a4 as U,ba as Z,p as e,v as r,b1 as u,bb as a,b2 as o,aV as l,am as g,b3 as A,b4 as E,aT as b,ai as ee,bc as se,bd as ae,b5 as re,be as te,F as ne,W as ie}from"./index-471b4ff3.js";import{A as oe}from"./AuthCard-e3069da1.js";const ce=3,F=30,ue=()=>{const[w,N]=s.useState(),[d,R]=s.useState(!0),{state:y}=Q(),[m,P]=s.useState("password"),T=m==="password"?"fa-eye-slash":"fa-eye",W=()=>P(m==="password"?"text":"password"),v=s.useRef(null),x=s.useRef(null),h=s.useRef(null),z=Y(),{handleSubmit:V,watch:$,register:k,formState:{isSubmitting:S,errors:I,isValid:B,dirtyFields:c}}=_({mode:"onChange"}),j=V(async t=>{var i,n,q,C;N("");try{await K(t),(i=X)==null||i.create({title:"Registration success",message:`Successfully register new user ${t.user}`,variant:f.success}),z(U.login,{state:y})}catch(p){const J=(C=(q=(n=p==null?void 0:p.response)==null?void 0:n.data)==null?void 0:q.errorMessage)!=null?C:"Register error";N(J)}});s.useEffect(()=>{h.current&&h.current.focus()},[]);const{ref:G,...O}=k("user",{required:!0,minLength:ce,maxLength:F}),D=s.useMemo(()=>!!c.user,[c.user]),H=s.useMemo(()=>!!c.passwd,[c.passwd]),L=s.useRef(Z(async t=>{var i;if(t)try{await te(t),R(!1)}catch(n){((i=n==null?void 0:n.response)==null?void 0:i.status)===404&&R(!0)}},180)).current,M=$("user");return s.useEffect(()=>{L(M)},[M,L]),e(oe,{children:r(u,{className:a.form,children:[r("div",{children:[e("h4",{className:a.title,children:"Welcome to Proof Market!"}),e("div",{className:`${a.heading} text-muted`,children:"Create new account"}),r(u.Group,{hasError:!!I.user||!d,children:[r(o,{size:l.lg,className:a.control,children:[e(o.Addon,{children:e(g,{iconName:"fa-solid fa-user",className:a.icon})}),e(A,{type:"text",id:"userName",placeholder:"username","aria-label":"username",ref:t=>{G(t),h.current=t},...O})]}),!d&&e(u.Hint,{children:"Username should be unique"})]}),e(E,{classNames:"fade",timeout:300,in:D,unmountOnExit:!0,nodeRef:v,children:e("div",{ref:v,children:e(u.Group,{hasError:!!I.passwd,children:r(o,{size:l.lg,className:a.control,children:[e(o.Addon,{children:e(g,{iconName:"fa-solid fa-lock",className:a.icon})}),e(A,{type:m,id:"password",placeholder:"password","aria-label":"password",autoComplete:"off",...k("passwd",{required:!0,maxLength:F})}),e(o.Buttons,{children:e(b,{onClick:W,children:e(g,{iconName:`fa-solid ${T}`,className:a.icon})})})]})})})}),e(E,{classNames:"fade",timeout:300,in:H,unmountOnExit:!0,nodeRef:x,children:e("div",{ref:x,children:r(b,{block:!0,variant:f.success,size:l.lg,disabled:S||!B||!d,onClick:j,children:["Register",S&&e(ee,{})]})})}),w&&e("div",{className:"errorMessage",children:w})]}),r("div",{className:a.bottomBlock,children:[r("div",{className:a.social,children:[e("h5",{className:a.title,children:"Join our Discord's proof-market channel/Telegram for questions/to stay updated"}),e(se,{socialLinks:ae})]}),e("h5",{className:"text-center text-muted",children:"Already have an account? "}),e(re,{to:U.login,state:y,children:e(b,{block:!0,variant:f.success,size:l.lg,children:"Sign in"})})]})]})})},me=()=>r(ne,{children:[e(ie,{children:e("title",{children:"Register"})}),e(ue,{})]});export{me as default};
