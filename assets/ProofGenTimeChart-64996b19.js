import{aK as O,O as m,a6 as P,a7 as y,a9 as F,r as l,aL as j,x as h,p as o,F as D,v as b,aM as M,aN as w,aO as E,aP as v,ah as U,aQ as p,am as H}from"./index-7371ffba.js";var $=(t=>(t.proofCostChart="Proof Cost",t.proofGetTimeChart="Proof Generation Time",t))($||{});const f=(t,a)=>O(t*1e3).format(a),q=(t,a)=>{const e=new Date(t);switch(a){case m.minute:e.setSeconds(0,0);break;case m.quaterMinute:x(e);break;case m.halfHour:e.setMinutes(e.getMinutes()>=30?30:0,0,0);break;case m.hour:e.setMinutes(0,0,0);break;case m.day:e.setHours(0,0,0,0);break}return e},x=t=>{const a=t.getMinutes();let e=0;a>=15&&a<30&&(e=15),a>=30&&a<45&&(e=30),a>=45&&(e=45),t.setMinutes(e,0,0)},A=(t,a)=>{const e=a?q(t,a):new Date(t);return Math.trunc(e.getTime()/1e3)},G=t=>t.chartsState.data,k=(t=!1,a=m.day)=>{const e=P(r=>r.statementsState.isLoading||r.chartsState.isLoading),n=y(G,F),s=l.useMemo(()=>Q(n,a),[n,a]);return{chartData:l.useMemo(()=>({candlestickChartData:R(s),proofGenTimeData:_(s),volumesData:t?z(s):void 0}),[s,t]),loadingData:e}},Q=(t,a)=>t.reduce((e,n)=>{const s=A(n.updatedOn,a);return e[s]||(e[s]=[]),e[s].push(n),e},{}),R=t=>{const a=Object.keys(t);return a.map((e,n)=>{const s=t[e].map(d=>d.cost),i=Math.max(...s),r=Math.min(...s),c=n===0?s[0]:t[a[n-1]].at(-1).cost,u=s[s.length-1];return{time:Number(e),high:i,low:r,open:c,close:u}})},_=t=>Object.keys(t).map(a=>{const e=t[a].map(s=>s.generation_time),n=j(e)/e.length;return{time:Number(a),value:n}}),z=t=>{const a=Object.keys(t);return a.map((e,n)=>{const s=t[e].map(c=>c.cost),i=n===0?s[0]:t[a[n-1]].at(-1).cost,r=s[s.length-1];return{time:Number(e),value:t[e].length,color:i<r?h.transparentSuccessColor:h.transparentDangerColor}})},K=({name:t,currentData:a})=>a===void 0?o(D,{}):b("div",{className:M.chartLegend,children:[o("strong",{className:M.chartName,children:t.toUpperCase()}),a.time&&o("span",{children:f(a.time,"DD.MM HH:mm")}),o(W,{data:a})]}),W=({data:t})=>{var a;switch(!0){case J(t):return o("div",{className:"text-muted",children:(a=t==null?void 0:t.value)==null?void 0:a.toFixed(2)});case I(t):return o(D,{children:Object.keys(t).map(e=>e!=="time"&&e!=="color"&&o("div",{className:"text-muted",children:`${e}: ${t[e].toFixed(2)}`},e))});default:return o(D,{})}},I=t=>"open"in t,J=t=>"value"in t,T=({chartName:t,loadingData:a,seriesType:e,seriesData:n,seriesOptions:s,chartOptions:i,volumesData:r,dataRange:c,displayVolumes:u,height:d})=>{const C=l.useRef(null),N=l.useMemo(()=>({...i,localization:{timeFormatter:g=>f(g,p(c))},timeScale:{tickMarkFormatter:g=>f(g,p(c)),fixRightEdge:!0,fixLeftEdge:!0},rightPriceScale:{scaleMargins:{top:.2,bottom:u?.3:.2}},leftPriceScale:{visible:u},crosshair:{mode:0}}),[i,c,u]),{chart:L}=w({ref:C,options:N}),{currentChartData:S}=E({seriesType:e,seriesData:n,chart:L,options:s,visibleRange:c,volumes:r});return b("div",{ref:C,className:v.chart,style:{height:d},children:[o(K,{currentData:S,name:t}),a&&n.length===0&&o("div",{className:v.spinner,children:o(U,{})})]})},Y=t=>{const a=l.useMemo(()=>({upColor:h.successColor,downColor:h.dangerColor,priceLineWidth:2}),[]),{chartData:{candlestickChartData:e,volumesData:n},loadingData:s}=k(t.displayVolumes,t.dataRange);return o(T,{loadingData:s,chartName:`Proof cost, ${H}`,seriesData:e,seriesType:"Candlestick",seriesOptions:a,volumesData:n,...t})},Z=t=>{const a=l.useMemo(()=>({color:h.infoColor}),[]),{chartData:{proofGenTimeData:e,volumesData:n},loadingData:s}=k(t.displayVolumes,t.dataRange);return o(T,{loadingData:s,chartName:"Proof Generation Time, min",seriesData:e,seriesType:"Line",seriesOptions:a,volumesData:n,...t})};export{$ as C,Z as P,Y as a};
